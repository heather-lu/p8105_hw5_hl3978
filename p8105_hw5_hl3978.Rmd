---
title: "p8105_hw5_hl3978"
author: "Heather Lu"
date: "2025-11-14"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(broom)
library(ggplot2)
set.seed(123)
```

# Problem 1

Suppose you put ğ‘›
 people in a room, and want to know the probability that at least two people share a birthday. For simplicity, weâ€™ll assume there are no leap years (i.e. there are only 365 days) and that birthdays are uniformly distributed over the year (which is actually not the case).

Write a function that, for a fixed group size, randomly draws â€œbirthdaysâ€ for each person; checks whether there are duplicate birthdays in the group; and returns TRUE or FALSE based on the result.

Next, run this function 10000 times for each group size between 2 and 50. For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. Make a plot showing the probability as a function of group size, and comment on your results.


```{r}
bday_match <- function(n) {
  birthdays <- sample(1:365, size = n, replace = TRUE)
  any(duplicated(birthdays))
}

group_sizes <- 2:50
n_sims <- 10000

shared_birthday_probs <- map_dbl(
  group_sizes,
  ~ mean(replicate(n_sims, bday_match(.x)))
)

shared_birthday_probs_df <- tibble(
  group_size = group_sizes,
  shared_birthday_prob = shared_birthday_probs
)

shared_birthday_probs_df |> 
  ggplot(aes(x = group_size, y = shared_birthday_prob)) + 
  geom_point() + 
  geom_line() + 
  labs(
    title = "Probability of shared birthday by group size",
    x = "Group size",
    y = "Probability of shared birthday"
  )

```
The plot shows that the probability of at least two people sharing a birthday increases non-linearly with group size. For very small groups (fewer than about 10 people), the probability is close to zero. As the group size increases, the probability grows quickly. Around 20â€“25 people it crosses roughly 0.5.By the time the group size reaches about 40â€“50 people, the probability is above 0.8 and approaches 1.

# Problem 2

When designing an experiment or analysis, a common question is whether it is likely that a true effect will be detected â€“ put differently, whether a false null hypothesis will be rejected. The probability that a false null hypothesis is rejected is referred to as power, and it depends on several factors, including: the sample size; the effect size; and the error variance. In this problem, you will conduct a simulation to explore power in a one-sample t-test.

First set the following design elements:

Fix ğ‘›=30
Fix ğœ=5
Set ğœ‡=0
. Generate 5000 datasets from the model

ğ‘¥âˆ¼ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™[ğœ‡,ğœ]

For each dataset, save ğœ‡Ì‚ 
 and the p-value arising from a test of ğ»:ğœ‡=0
 using ğ›¼=0.05
. Hint: to obtain the estimate and p-value, use broom::tidy to clean the output of t.test.

Repeat the above for ğœ‡={1,2,3,4,5,6}
, and complete the following:

- Make a plot showing the proportion of times the null was rejected (the power of the test) on the y axis and the true value of ğœ‡
 on the x axis. Describe the association between effect size and power.
 
- Make a plot showing the average estimate of ğœ‡Ì‚ 
 on the y axis and the true value of ğœ‡
 on the x axis. Make a second plot (or overlay on the first) the average estimate of ğœ‡Ì‚ 
 only in samples for which the null was rejected on the y axis and the true value of ğœ‡
 on the x axis. Is the sample average of ğœ‡Ì‚ 
 across tests for which the null is rejected approximately equal to the true value of ğœ‡
? Why or why not?

```{r}

```


